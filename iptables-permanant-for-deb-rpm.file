#!/bin/bash

# List of IP addresses to drop
IPS=(
    132.154.2.101
    132.154.60.1
    132.154.57.50
    117.202.134.244
    152.58.226.186
    103.174.141.228
    171.78.226.41
    103.121.71.118
    24.253.6.232
    3.225.248.243
    68.64.164.89
    54.164.141.13
    3.222.234.99
    3.216.119.146
    18.184.197.212
    3.33.143.57
    103.68.221.190
    224.0.0.252
    139.99.233.175
    189.206.147.227
    138.197.80.117
    89.45.159.126
    172.80.252.12
    45.9.74.14
    194.165.16.4
    185.202.0.111
    147.78.47.224
    185.112.82.235
    185.112.82.236
    103.231.211.183
    103.231.211.185
    185.195.233.15
    117.99.10.90
    132.154.55.203
    132.154.56.243
    132.154.7.131
    132.154.58.1
    13.234.36.75
    185.112.82.237
    95.164.3.250
    209.197.3.8
    23.216.147.76
    80.66.88.203
    20.99.184.37
    23.216.147.64
    45.227.254.26
    91.240.118.29
    194.26.29.102
    185.11.61.114
    23.216.147.76
    152.89.196.111
    23.216.147.64
    202.175.136.197
    208.111.186.128
    131.170.255.255
)

# Drop incoming and outgoing traffic for each IP
for IP in "${IPS[@]}"; do
    iptables -A INPUT -s $IP -j DROP
    iptables -A OUTPUT -d $IP -j DROP
done

# Save the iptables rules
if [ -x "$(command -v apt-get)" ]; then
    # Debian-based systems
    apt-get install iptables-persistent -y
    iptables-save > /etc/iptables/rules.v4
    ip6tables-save > /etc/iptables/rules.v6

    systemctl enable netfilter-persistent
    systemctl start netfilter-persistent
elif [ -x "$(command -v yum)" ]; then
    # RHEL-based systems
    yum install iptables -y
    service iptables save
    systemctl enable iptables
    systemctl start iptables
else
    echo "Unsupported OS"
    exit 1
fi

